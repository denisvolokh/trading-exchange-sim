<!doctype html>
<html>
    <head>
        <title>Exchange Order Book</title>
        <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.6/dist/htmx.min.js"></script>
        <link
            href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
            rel="stylesheet"
        />
    </head>
    <body class="bg-gray-50 min-h-screen p-4">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">
            ðŸ“Š Exchange Emulator
        </h1>

        <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Order Form -->
            <div class="bg-white rounded-lg shadow p-4">
                <div hx-get="/ui/form" hx-trigger="load" hx-swap="outerHTML">
                    Loading form...
                </div>
            </div>

            <!-- Order Book -->
            <div class="bg-white rounded-lg shadow p-4">
                <h2
                    class="text-xl font-semibold mb-2 text-center text-blue-800"
                >
                    Order Book
                </h2>
                <div
                    id="orderbook"
                    hx-get="/ui/orderbook"
                    hx-trigger="load, order-submitted, sse:update"
                    hx-swap="outerHTML"
                >
                    Loading order book...
                </div>
            </div>

            <!-- Trades -->
            <div class="bg-white rounded-lg shadow p-4">
                <h2
                    class="text-xl font-semibold mb-2 text-center text-green-800"
                >
                    Recent Trades
                </h2>
                <div
                    id="trades"
                    hx-get="/ui/trades"
                    hx-trigger="load, trade-matched, sse:trade"
                    hx-swap="outerHTML"
                >
                    Loading trades...
                </div>
            </div>
        </div>

        <script>
            const evtSource = new EventSource("/sse");
            evtSource.onmessage = () => {
                htmx.trigger("body", "sse:update");
                htmx.trigger("body", "sse:trade");
            };

            document.body.addEventListener("order-submitted", () => {
                console.log("[HTMX] order-submitted triggered");
            });
        </script>
    </body>
</html>
